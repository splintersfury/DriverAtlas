# API categorization for DriverAtlas structural fingerprinting
# Maps kernel symbols to functional categories for driver profiling.

categories:

  memory_management:
    description: Pool allocation and deallocation
    symbols:
      - ExAllocatePool
      - ExAllocatePoolWithTag
      - ExAllocatePool2
      - ExAllocatePool3
      - ExAllocatePoolZero
      - ExAllocatePoolWithQuota
      - ExAllocatePoolWithQuotaTag
      - ExFreePool
      - ExFreePoolWithTag
      - MmAllocateNonCachedMemory
      - MmFreeNonCachedMemory
      - MmAllocateContiguousMemory
      - MmFreeContiguousMemory
      - MmAllocatePagesForMdl
      - MmFreePagesFromMdl
      - MmMapLockedPages
      - MmUnmapLockedPages
      - MmMapLockedPagesSpecifyCache

  memory_copy:
    description: Memory copy/move/zero/fill primitives
    symbols:
      - RtlCopyMemory
      - memcpy
      - memmove
      - RtlMoveMemory
      - RtlCopyBytes
      - RtlCopyMappedMemory
      - RtlZeroMemory
      - RtlSecureZeroMemory
      - RtlFillMemory
      - memset

  synchronization:
    description: Spin locks, mutexes, events, and critical regions
    symbols:
      - KeAcquireSpinLock
      - KeReleaseSpinLock
      - KeAcquireSpinLockAtDpcLevel
      - KeReleaseSpinLockFromDpcLevel
      - KeAcquireInStackQueuedSpinLock
      - KeReleaseInStackQueuedSpinLock
      - ExAcquireFastMutex
      - ExReleaseFastMutex
      - ExAcquireResourceExclusiveLite
      - ExAcquireResourceSharedLite
      - ExReleaseResourceLite
      - KeEnterCriticalRegion
      - KeLeaveCriticalRegion
      - KeInitializeEvent
      - KeSetEvent
      - KeResetEvent
      - KeWaitForSingleObject
      - KeWaitForMultipleObjects
      - KeInitializeMutex
      - KeReleaseMutex
      - InterlockedIncrement
      - InterlockedDecrement
      - InterlockedExchange
      - InterlockedCompareExchange

  irp_handling:
    description: IRP creation, completion, and dispatch
    symbols:
      - IoCompleteRequest
      - IofCompleteRequest
      - IoCallDriver
      - IofCallDriver
      - PoCallDriver
      - IoAllocateIrp
      - IoFreeIrp
      - IoBuildDeviceIoControlRequest
      - IoBuildSynchronousFsdRequest
      - IoBuildAsynchronousFsdRequest
      - IoSetCompletionRoutine
      - IoSetCompletionRoutineEx
      - IoSetCancelRoutine
      - IoGetCurrentIrpStackLocation
      - IoGetNextIrpStackLocation
      - IoCopyCurrentIrpStackLocationToNext
      - IoSkipCurrentIrpStackLocation
      - IoMarkIrpPending
      - IoCsqInsertIrp
      - IoCsqRemoveIrp

  mdl_ops:
    description: Memory Descriptor List operations
    symbols:
      - IoAllocateMdl
      - IoFreeMdl
      - MmGetSystemAddressForMdlSafe
      - MmGetSystemAddressForMdl
      - MmProbeAndLockPages
      - MmUnlockPages
      - MmBuildMdlForNonPagedPool
      - IoBuildPartialMdl

  registry:
    description: Registry access and manipulation
    symbols:
      - ZwOpenKey
      - ZwCreateKey
      - ZwQueryValueKey
      - ZwSetValueKey
      - ZwDeleteKey
      - ZwDeleteValueKey
      - ZwEnumerateKey
      - ZwEnumerateValueKey
      - ZwClose
      - RtlQueryRegistryValues
      - RtlWriteRegistryValue
      - RtlCheckRegistryKey
      - RtlDeleteRegistryValue
      - IoOpenDeviceRegistryKey
      - WdfRegistryOpenKey
      - WdfRegistryQueryValue

  file_ops:
    description: File I/O operations
    symbols:
      - ZwCreateFile
      - ZwOpenFile
      - ZwReadFile
      - ZwWriteFile
      - ZwQueryInformationFile
      - ZwSetInformationFile
      - ZwQueryDirectoryFile
      - ZwClose
      - ObReferenceObjectByHandle
      - FltCreateFile
      - FltCreateFileEx2
      - FltReadFile
      - FltWriteFile

  network:
    description: Network and TDI/WFP/WSK operations
    symbols:
      - FwpsCalloutRegister0
      - FwpsCalloutRegister1
      - FwpsCalloutRegister2
      - FwpsCalloutRegister3
      - FwpmFilterAdd0
      - FwpmSubLayerAdd0
      - FwpmEngineOpen0
      - FwpmEngineClose0
      - FwpsCompleteClassify0
      - FwpsAcquireClassifyHandle0
      - FwpsReleaseClassifyHandle0
      - FwpsFlowAssociateContext0
      - WskCaptureProviderNPI
      - WskReleaseProviderNPI
      - NdisGetDataBuffer
      - NdisQueryMdl
      - NdisAllocateNetBufferListPool
      - NdisFreeNetBufferListPool
      - NdisSendNetBufferLists

  process_thread:
    description: Process and thread management
    symbols:
      - PsCreateSystemThread
      - PsTerminateSystemThread
      - PsGetCurrentProcessId
      - PsGetCurrentThreadId
      - PsGetCurrentProcess
      - PsLookupProcessByProcessId
      - PsLookupThreadByThreadId
      - PsSetCreateProcessNotifyRoutine
      - PsSetCreateProcessNotifyRoutineEx
      - PsSetCreateThreadNotifyRoutine
      - PsSetLoadImageNotifyRoutine
      - KeGetCurrentThread
      - KeGetCurrentIrql
      - KeSetSystemAffinityThread
      - ZwTerminateProcess

  object_mgmt:
    description: Object manager operations
    symbols:
      - ObReferenceObject
      - ObReferenceObjectByHandle
      - ObReferenceObjectByPointer
      - ObDereferenceObject
      - ObfDereferenceObject
      - ObReferenceObjectWithTag
      - ObDereferenceObjectWithTag
      - ObRegisterCallbacks
      - ObUnRegisterCallbacks

  string_handling:
    description: String manipulation and conversion
    symbols:
      - RtlInitUnicodeString
      - RtlFreeUnicodeString
      - RtlCopyUnicodeString
      - RtlCompareUnicodeString
      - RtlEqualUnicodeString
      - RtlUnicodeStringToAnsiString
      - RtlAnsiStringToUnicodeString
      - RtlInitAnsiString
      - RtlStringCbCopyA
      - RtlStringCbCopyW
      - RtlStringCchCopyA
      - RtlStringCchCopyW
      - RtlStringCbCatA
      - RtlStringCbCatW
      - RtlStringCchPrintfA
      - RtlStringCbPrintfW
      - RtlIntegerToUnicodeString
      - wcscpy
      - strcpy
      - sprintf
      - swprintf

  device_mgmt:
    description: Device object creation and management
    symbols:
      - IoCreateDevice
      - IoCreateDeviceSecure
      - IoDeleteDevice
      - IoCreateSymbolicLink
      - IoDeleteSymbolicLink
      - IoAttachDeviceToDeviceStack
      - IoDetachDevice
      - IoGetDeviceObjectPointer
      - IoRegisterDeviceInterface
      - IoSetDeviceInterfaceState
      - WdfDeviceCreate
      - WdfDeviceInitSetIoType
      - WdfDeviceCreateDeviceInterface

  power_pnp:
    description: Power management and Plug-and-Play
    symbols:
      - IoAcquireRemoveLock
      - IoReleaseRemoveLock
      - IoReleaseRemoveLockAndWait
      - IoInitializeRemoveLock
      - PoSetPowerState
      - PoStartNextPowerIrp
      - PoRequestPowerIrp
      - PoRegisterPowerSettingCallback
      - IoRegisterPlugPlayNotification
      - IoInvalidateDeviceRelations
      - IoReportTargetDeviceChange
      - WdfDeviceInitSetPnpPowerEventCallbacks

  dma:
    description: DMA and scatter/gather operations
    symbols:
      - IoGetDmaAdapter
      - AllocateCommonBuffer
      - FreeCommonBuffer
      - GetScatterGatherList
      - PutScatterGatherList
      - MapTransfer
      - FlushAdapterBuffers
      - MmMapIoSpace
      - MmMapIoSpaceEx
      - MmUnmapIoSpace
      - READ_REGISTER_ULONG
      - WRITE_REGISTER_ULONG
      - READ_PORT_UCHAR
      - WRITE_PORT_UCHAR

  crypto:
    description: Cryptographic operations
    symbols:
      - BCryptOpenAlgorithmProvider
      - BCryptCloseAlgorithmProvider
      - BCryptGenerateSymmetricKey
      - BCryptEncrypt
      - BCryptDecrypt
      - BCryptCreateHash
      - BCryptHashData
      - BCryptFinishHash
      - BCryptDestroyHash
      - BCryptDestroyKey
      - BCryptGenRandom
      - BCryptSignHash
      - BCryptVerifySignature

  security:
    description: Security and access control
    symbols:
      - SeAccessCheck
      - SeSinglePrivilegeCheck
      - SePrivilegeCheck
      - SeFreePrivileges
      - ExGetPreviousMode
      - ProbeForRead
      - ProbeForWrite
      - IoCheckEaBufferValidity
      - IoIs32bitProcess
      - RtlULongAdd
      - RtlULongMult
      - RtlSizeTAdd
      - RtlSizeTMult

  etw_tracing:
    description: Event Tracing for Windows
    symbols:
      - EtwRegister
      - EtwUnregister
      - EtwWrite
      - EtwWriteTransfer
      - EtwActivityIdControl
      - WPP_INIT_TRACING
      - WPP_CLEANUP
      - IoWMIRegistrationControl
      - IoWMIWriteEvent
      - WmiTraceMessage
      - TraceLoggingRegister
      - TraceLoggingUnregister
      - TraceLoggingWrite

  timer_dpc:
    description: Timers, DPCs, and work items
    symbols:
      - KeInitializeTimer
      - KeInitializeTimerEx
      - KeSetTimer
      - KeSetTimerEx
      - KeCancelTimer
      - KeInitializeDpc
      - KeInsertQueueDpc
      - KeRemoveQueueDpc
      - IoAllocateWorkItem
      - IoFreeWorkItem
      - IoQueueWorkItem
      - ExInitializeWorkItem
      - ExQueueWorkItem
      - KeDelayExecutionThread
